<!DOCTYPE html>
<html>
        <head>
                <meta charset='utf-8'>
                <title> 竜の翼亭食事計算 </title>
<style>
#list { display: grid; }
#efficient-set { display: grid; }
.menu { display: flex; }
.name { min-width: 20em; }
</style>
        </head>
        <body>
        <div>
                <input id='how-to-use-switch' type='button' value='' onclick='how_to_use()'>
                <div id='how-to-use'>
                        <p><code>Next</code>には次のレベルまでに必要な経験値を入力します。<br>
                        <code>Life</code> ~ <code>Luck</code>には各パラメタの現在のexpを入力します。<br>
                        <code>Order</code>で料理リストをどのパラメタでソートするかを指定します。<br>
                        <code>Exp</code>には次の冒険で得られるであろうexpを入力します。
                        （少なめに見積もるのがコツです。）<br>
                        リストから<code>eat</code>ボタンで料理を胃に追加すると各パラメタが更新されます。<br>
                        <code>vomit</code>で吐き出すとundoできます。<br>
                        <code>digest</code>で消化できます。<br>
                        <code>Compute efficient set</code>ボタンを押すと、<code>Exp</code>の値に従って最も多くのexpを得られる料理セットでレベルを上げずにすむセットを計算します。<br>
                        黒文字のリストは食べてもレベルが上がらない料理で<code>Order</code>で指定されたパラメタにexpが入るものです。<br>
                        オレンジ文字のリストは食べてもレベルが上がらない料理で<code>Order</code>で指定されたパラメタにexpが入らないものです。<br>
                        赤文字のリストは食べるとレベルが上がってしまう料理です。<br>
                        これは食べるとレベルが上がるパラメタ数が多い順にソートされています。
                </div>
        </div>
                <table>
                        <tr>
                                <th>Next</th>
                                <th>Exp</th>
                                <th>Life</th>
                                <th>Awake</th>
                                <th>Breath</th>
                                <th>Strength</th>
                                <th>Arm</th>
                                <th>Tech</th>
                                <th>Magic</th>
                                <th>Luck</th>
                                <th>Order</th>
                        </tr>
                        <tr>
                                <td><input class='input' id='next' type='number' value='30'></td>
                                <td><input class='input' id='exp' type='number' value='100'></td>
                                <td><input class='input' id='life' type='number' value='0'></td>
                                <td><input class='input' id='awake' type='number' value='0'></td>
                                <td><input class='input' id='breath' type='number' value='0'></td>
                                <td><input class='input' id='strength' type='number' value='0'></td>
                                <td><input class='input' id='arm' type='number' value='0'></td>
                                <td><input class='input' id='tech' type='number' value='0'></td>
                                <td><input class='input' id='magic' type='number' value='0'></td>
                                <td><input class='input' id='luck' type='number' value='0'></td>
                                <td>
                                        <select class='input' id='order'>
                                                <option value='life'>life</option>
                                                <option value='awake'>awake</option>
                                                <option value='breath'>breath</option>
                                                <option value='strength'>strength</option>
                                                <option value='arm'>arm</option>
                                                <option value='tech'>tech</option>
                                                <option value='magic'>magic</option>
                                                <option value='luck'>luck</option>
                                                <option value='exp'>exp</option>
                                        </select>
                                </td>
                        </tr>
                </table>
                <div>
                        <input id='levelup' type='button' value='Level Up' onclick='levelup()'>
                        <input id='efficient' type='button' value='Compute efficient set.' onclick='efficient()'>
                        <span id='efficient-set'>NOTE: This may take some minutes.</span>
                </div>
                <div id='stomack'>
                        <input id='vomit' type='button' value='vomit' onclick='vomit()'>
                        <input id='digest' type='button' value='digest' onclick='digest()'>
                        Stomack: <span id='status'>[]</span>
                </div>
                <div id='list'>
<div class='menu'>
  <input type='button' value='eat' onclick='add(0)'>
  <span class='name'>失敗料理</span>
  <span class='param'>[5, 5, 5, 5, 5, 5, 5, 5, 100]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(1)'>
  <span class='name'>塩むすび</span>
  <span class='param'>[20, 0, 30, 0, 10, 0, 0, 0, 180]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(2)'>
  <span class='name'>梅にぎり</span>
  <span class='param'>[20, 10, 40, 0, 20, 0, 10, 0, 350]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(3)'>
  <span class='name'>エビフライライス</span>
  <span class='param'>[50, 20, 50, 10, 20, 10, 0, 0, 630]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(4)'>
  <span class='name'>ねじりパン</span>
  <span class='param'>[30, 0, 30, 20, 0, 20, 0, 0, 350]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(5)'>
  <span class='name'>バターロール</span>
  <span class='param'>[70, 0, 30, 10, 20, 10, 0, 20, 630]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(6)'>
  <span class='name'>げんこつパン</span>
  <span class='param'>[45, 0, 55, 0, 10, 0, 0, 0, 390]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(7)'>
  <span class='name'>バタール</span>
  <span class='param'>[40, 0, 40, 0, 20, 0, 0, 0, 350]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(8)'>
  <span class='name'>パン・ド・ミ</span>
  <span class='param'>[40, 0, 60, 10, 20, 0, 0, 10, 530]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(9)'>
  <span class='name'>クロワッサン</span>
  <span class='param'>[90, 0, 70, 0, 10, 0, 0, 30, 840]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(10)'>
  <span class='name'>ベーコンエッグパイ</span>
  <span class='param'>[70, 0, 60, 30, 25, 15, 0, 0, 840]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(11)'>
  <span class='name'>バタートースト</span>
  <span class='param'>[60, 0, 50, 0, 10, 20, 10, 10, 630]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(12)'>
  <span class='name'>メロンパン</span>
  <span class='param'>[95, 70, 75, 0, 0, 0, 70, 20, 1720]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(13)'>
  <span class='name'>チョココロネ</span>
  <span class='param'>[75, 0, 75, 0, 0, 0, 0, 0, 580]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(14)'>
  <span class='name'>ホットドッグ</span>
  <span class='param'>[60, 0, 75, 30, 45, 0, 0, 0, 890]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(15)'>
  <span class='name'>デブキングバーガー</span>
  <span class='param'>[90, 0, 110, 40, 60, 35, 25, 10, 2250]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(16)'>
  <span class='name'>ミートパイ</span>
  <span class='param'>[105, 0, 125, 65, 70, 15, 0, 0, 2400]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(17)'>
  <span class='name'>BLTサンド</span>
  <span class='param'>[60, 0, 60, 45, 25, 80, 30, 30, 1720]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(18)'>
  <span class='name'>サブ道サンド</span>
  <span class='param'>[50, 20, 70, 0, 0, 30, 30, 0, 840]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(19)'>
  <span class='name'>スシ</span>
  <span class='param'>[40, 40, 100, 0, 20, 0, 0, 0, 840]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(20)'>
  <span class='name'>チーズリゾット</span>
  <span class='param'>[130, 0, 70, 0, 20, 0, 0, 40, 1170]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(21)'>
  <span class='name'>きのこのリゾット</span>
  <span class='param'>[120, 0, 70, 0, 20, 30, 30, 30, 1400]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(22)'>
  <span class='name'>ホットリゾット</span>
  <span class='param'>[60, 0, 110, 55, 80, 0, 0, 25, 1720]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(23)'>
  <span class='name'>ニンニクのパスタ</span>
  <span class='param'>[60, 0, 50, 0, 10, 30, 30, 0, 730]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(24)'>
  <span class='name'>ベーコンのチーズクリームパスタ</span>
  <span class='param'>[115, 0, 60, 70, 50, 35, 0, 40, 2250]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(25)'>
  <span class='name'>トマトソースパスタ</span>
  <span class='param'>[75, 0, 60, 30, 15, 40, 40, 30, 1340]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(26)'>
  <span class='name'>ペスカトーレ</span>
  <span class='param'>[65, 40, 90, 0, 15, 20, 0, 20, 1110]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(27)'>
  <span class='name'>シャバシャバカレー</span>
  <span class='param'>[70, 0, 120, 30, 80, 50, 30, 20, 2720]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(28)'>
  <span class='name'>ビーフカレー</span>
  <span class='param'>[70, 0, 120, 50, 100, 0, 0, 0, 1840]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(29)'>
  <span class='name'>エッグカレー</span>
  <span class='param'>[85, 0, 135, 90, 100, 65, 25, 0, 4400]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(30)'>
  <span class='name'>ドンカツカレー</span>
  <span class='param'>[100, 0, 125, 70, 175, 20, 20, 0, 4520]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(31)'>
  <span class='name'>ベーコンオムレツ</span>
  <span class='param'>[70, 0, 70, 130, 40, 60, 0, 30, 2720]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(32)'>
  <span class='name'>ビーフシチューオムライス</span>
  <span class='param'>[85, 0, 60, 110, 75, 85, 0, 25, 3490]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(33)'>
  <span class='name'>カロリーバー</span>
  <span class='param'>[40, 25, 40, 50, 0, 0, 25, 50, 1000]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(34)'>
  <span class='name'>抹茶カロリーバー</span>
  <span class='param'>[50, 35, 50, 50, 0, 35, 35, 85, 1840]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(35)'>
  <span class='name'>カカオバー</span>
  <span class='param'>[50, 85, 50, 50, 0, 0, 85, 50, 2250]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(36)'>
  <span class='name'>じゃがバター</span>
  <span class='param'>[10, 0, 0, 0, 10, 30, 30, 0, 260]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(37)'>
  <span class='name'>ミックスピザ</span>
  <span class='param'>[100, 30, 90, 30, 30, 40, 40, 40, 2720]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(38)'>
  <span class='name'>オリーブのピザ</span>
  <span class='param'>[170, 35, 70, 0, 50, 0, 35, 50, 2900]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(39)'>
  <span class='name'>海鮮のピザ</span>
  <span class='param'>[155, 60, 130, 0, 35, 25, 0, 75, 4170]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(40)'>
  <span class='name'>カップ麺</span>
  <span class='param'>[75, 0, 45, 20, 70, 0, 0, 0, 890]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(41)'>
  <span class='name'>フライの盛り合わせ</span>
  <span class='param'>[60, 45, 45, 0, 60, 45, 45, 0, 1400]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(42)'>
  <span class='name'>日の丸弁当</span>
  <span class='param'>[40, 35, 75, 35, 35, 65, 30, 35, 1970]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(43)'>
  <span class='name'>味噌にぎり</span>
  <span class='param'>[65, 0, 90, 0, 25, 30, 0, 30, 1050]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(44)'>
  <span class='name'>トロ三点盛り</span>
  <span class='param'>[50, 100, 180, 0, 30, 0, 0, 0, 2100]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(45)'>
  <span class='name'>寿司</span>
  <span class='param'>[40, 55, 120, 0, 25, 0, 0, 0, 1050]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(46)'>
  <span class='name'>濃厚ヌードルスープ</span>
  <span class='param'>[55, 50, 155, 0, 50, 45, 45, 0, 2720]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(47)'>
  <span class='name'>プラチナたこ</span>
  <span class='param'>[135, 60, 145, 0, 50, 0, 0, 0, 2550]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(48)'>
  <span class='name'>ミートジャーキー</span>
  <span class='param'>[0, 0, 10, 20, 30, 0, 0, 0, 180]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(49)'>
  <span class='name'>すね肉のワイルド焼き</span>
  <span class='param'>[15, 0, 15, 35, 65, 0, 0, 0, 480]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(50)'>
  <span class='name'>マンガ肉</span>
  <span class='param'>[40, 0, 15, 60, 115, 0, 0, 0, 1000]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(51)'>
  <span class='name'>キングオブミート</span>
  <span class='param'>[50, 0, 25, 90, 165, 10, 0, 0, 1970]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(52)'>
  <span class='name'>魔獣肉の燻製</span>
  <span class='param'>[35, 20, 0, 50, 85, 25, 20, 25, 1170]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(53)'>
  <span class='name'>ローストビーフ</span>
  <span class='param'>[40, 0, 20, 60, 120, 30, 0, 30, 1400]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(54)'>
  <span class='name'>丸ごとローストチキン</span>
  <span class='param'>[25, 0, 0, 80, 105, 80, 35, 45, 2250]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(55)'>
  <span class='name'>骨付きソーセージ</span>
  <span class='param'>[10, 0, 35, 40, 85, 0, 0, 0, 680]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(56)'>
  <span class='name'>サイコロステーキ</span>
  <span class='param'>[10, 0, 0, 35, 45, 20, 0, 20, 480]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(57)'>
  <span class='name'>もも肉のステーキ</span>
  <span class='param'>[20, 0, 0, 65, 65, 60, 35, 45, 1340]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(58)'>
  <span class='name'>ラムステーキ</span>
  <span class='param'>[55, 0, 25, 55, 85, 35, 0, 35, 1340]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(59)'>
  <span class='name'>A5ステーキ</span>
  <span class='param'>[40, 0, 30, 140, 185, 0, 0, 25, 3080]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(60)'>
  <span class='name'>チーズinハンバーグ</span>
  <span class='param'>[70, 0, 50, 65, 85, 0, 0, 40, 1500]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(61)'>
  <span class='name'>トカゲの蒲焼き</span>
  <span class='param'>[0, 40, 0, 35, 35, 0, 40, 0, 580]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(62)'>
  <span class='name'>フライドチキン</span>
  <span class='param'>[50, 0, 30, 50, 130, 0, 0, 0, 1170]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(63)'>
  <span class='name'>ベーコンエッグ</span>
  <span class='param'>[0, 0, 0, 60, 30, 30, 0, 0, 440]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(64)'>
  <span class='name'>ボンレスハム</span>
  <span class='param'>[0, 0, 40, 70, 110, 0, 0, 0, 940]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(65)'>
  <span class='name'>BBQ</span>
  <span class='param'>[0, 0, 65, 75, 140, 45, 0, 45, 2250]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(66)'>
  <span class='name'>貝のバター焼き</span>
  <span class='param'>[20, 25, 25, 0, 0, 0, 0, 20, 300]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(67)'>
  <span class='name'>串刺し焼き魚</span>
  <span class='param'>[0, 35, 50, 0, 15, 0, 0, 0, 350]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(68)'>
  <span class='name'>黄金魚の串焼き</span>
  <span class='param'>[0, 100, 55, 0, 0, 0, 45, 0, 840]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(69)'>
  <span class='name'>あんかけムニエル</span>
  <span class='param'>[15, 85, 65, 0, 15, 30, 50, 0, 1170]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(70)'>
  <span class='name'>魚のオイルホイル焼き</span>
  <span class='param'>[35, 65, 65, 0, 35, 55, 25, 30, 1500]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(71)'>
  <span class='name'>ブリっと丸焼き</span>
  <span class='param'>[25, 110, 90, 0, 25, 40, 60, 0, 1970]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(72)'>
  <span class='name'>空色の刺身</span>
  <span class='param'>[0, 110, 75, 0, 0, 35, 35, 35, 1340]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(73)'>
  <span class='name'>白身魚のカルパッチョ</span>
  <span class='param'>[60, 60, 85, 0, 35, 50, 0, 50, 1840]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(74)'>
  <span class='name'>サーモンのカルパッチョ</span>
  <span class='param'>[75, 75, 105, 30, 45, 0, 0, 30, 2100]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(75)'>
  <span class='name'>虹貝の塩茹で</span>
  <span class='param'>[25, 80, 95, 0, 40, 0, 0, 0, 1050]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(76)'>
  <span class='name'>フィッシュステーキ</span>
  <span class='param'>[80, 60, 60, 0, 30, 30, 0, 80, 1840]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(77)'>
  <span class='name'>ダブルピースグラタン</span>
  <span class='param'>[100, 80, 80, 0, 35, 50, 50, 65, 3930]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(78)'>
  <span class='name'>茹でタコ足</span>
  <span class='param'>[0, 35, 35, 0, 0, 0, 0, 0, 220]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(79)'>
  <span class='name'>輪切りサーモン</span>
  <span class='param'>[15, 35, 35, 0, 15, 0, 0, 0, 350]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(80)'>
  <span class='name'>エスカルゴのソテー</span>
  <span class='param'>[60, 70, 100, 0, 90, 0, 0, 0, 1610]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(81)'>
  <span class='name'>北海のクラブグラタン</span>
  <span class='param'>[55, 100, 100, 0, 0, 65, 65, 55, 3490]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(82)'>
  <span class='name'>ドデカ兜焼き</span>
  <span class='param'>[45, 100, 150, 0, 95, 50, 0, 50, 4280]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(83)'>
  <span class='name'>何かのさなぎ</span>
  <span class='param'>[0, 50, 110, 60, 120, 40, 0, 40, 3080]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(84)'>
  <span class='name'>太古風サラダ</span>
  <span class='param'>[0, 0, 0, 15, 0, 40, 15, 40, 390]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(85)'>
  <span class='name'>ソースで味わうスティック野菜</span>
  <span class='param'>[0, 15, 0, 0, 0, 75, 55, 35, 730]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(86)'>
  <span class='name'>シーザーサラダ</span>
  <span class='param'>[30, 0, 0, 35, 0, 85, 40, 110, 1400]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(87)'>
  <span class='name'>マンドラのシロップがけ</span>
  <span class='param'>[0, 25, 0, 0, 0, 95, 80, 40, 1050]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(88)'>
  <span class='name'>マンドラの日干し</span>
  <span class='param'>[0, 30, 15, 0, 15, 65, 95, 0, 940]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(89)'>
  <span class='name'>マンドラの薬漬け</span>
  <span class='param'>[0, 30, 15, 0, 15, 120, 105, 45, 1720]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(90)'>
  <span class='name'>ジャンボ蜂の子のシロップがけ</span>
  <span class='param'>[0, 110, 0, 75, 0, 30, 110, 45, 2250]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(91)'>
  <span class='name'>病院お見舞いセット</span>
  <span class='param'>[0, 130, 0, 0, 0, 45, 175, 0, 1970]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(92)'>
  <span class='name'>マツタケの香ばし焼き</span>
  <span class='param'>[20, 0, 0, 0, 20, 45, 0, 45, 480]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(93)'>
  <span class='name'>ゴーヤチャンプル</span>
  <span class='param'>[0, 0, 0, 75, 30, 95, 50, 0, 1110]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(94)'>
  <span class='name'>漬物</span>
  <span class='param'>[0, 0, 30, 0, 30, 25, 25, 0, 390]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(95)'>
  <span class='name'>野菜鍋</span>
  <span class='param'>[0, 0, 0, 95, 45, 110, 50, 110, 2900]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(96)'>
  <span class='name'>エリンギャーの照り焼き</span>
  <span class='param'>[40, 35, 0, 0, 40, 85, 35, 85, 1610]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(97)'>
  <span class='name'>豆のスープ</span>
  <span class='param'>[0, 0, 0, 25, 0, 15, 0, 40, 260]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(98)'>
  <span class='name'>コーンポタージュ</span>
  <span class='param'>[55, 0, 25, 0, 0, 15, 15, 30, 530]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(99)'>
  <span class='name'>ホットミネストローネ</span>
  <span class='param'>[0, 0, 30, 50, 50, 0, 0, 30, 630]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(100)'>
  <span class='name'>カボチャのポタージュ</span>
  <span class='param'>[35, 25, 35, 0, 0, 65, 90, 0, 1110]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(101)'>
  <span class='name'>キノコのポタージュ</span>
  <span class='param'>[30, 0, 0, 30, 0, 75, 0, 75, 890]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(102)'>
  <span class='name'>薬草のスープ</span>
  <span class='param'>[0, 25, 0, 0, 0, 60, 55, 30, 680]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(103)'>
  <span class='name'>魔物のミルクスープ</span>
  <span class='param'>[65, 35, 35, 0, 30, 0, 0, 35, 840]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(104)'>
  <span class='name'>チキンのクリームスープ</span>
  <span class='param'>[50, 0, 0, 85, 60, 40, 40, 75, 1970]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(105)'>
  <span class='name'>北のキャロットスープ</span>
  <span class='param'>[50, 35, 0, 35, 0, 110, 110, 50, 2520]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(106)'>
  <span class='name'>ビーフシチュー</span>
  <span class='param'>[35, 0, 30, 115, 140, 30, 30, 40, 3080]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(107)'>
  <span class='name'>激辛魔女鍋</span>
  <span class='param'>[0, 25, 125, 0, 100, 0, 0, 0, 1110]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(108)'>
  <span class='name'>なめこ汁</span>
  <span class='param'>[30, 0, 30, 35, 0, 30, 0, 65, 780]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(109)'>
  <span class='name'>フォンデュパン</span>
  <span class='param'>[100, 0, 0, 150, 50, 140, 40, 100, 5380]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(110)'>
  <span class='name'>紅茶</span>
  <span class='param'>[0, 0, 0, 0, 0, 20, 0, 20, 110]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(111)'>
  <span class='name'>ブレンドコーヒー</span>
  <span class='param'>[0, 0, 0, 35, 0, 10, 10, 35, 300]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(112)'>
  <span class='name'>ホットココア</span>
  <span class='param'>[0, 60, 0, 0, 0, 0, 60, 0, 440]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(113)'>
  <span class='name'>唐辛子茶</span>
  <span class='param'>[0, 0, 30, 0, 30, 25, 0, 25, 390]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(114)'>
  <span class='name'>カフェラッテ</span>
  <span class='param'>[25, 70, 0, 0, 0, 0, 70, 25, 780]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(115)'>
  <span class='name'>風呂上り牛乳</span>
  <span class='param'>[30, 15, 0, 0, 0, 0, 15, 30, 300]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(116)'>
  <span class='name'>アイスティー</span>
  <span class='param'>[0, 15, 0, 0, 0, 45, 15, 45, 440]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(117)'>
  <span class='name'>第四のビール</span>
  <span class='param'>[50, 25, 75, 0, 25, 0, 25, 0, 840]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(118)'>
  <span class='name'>ココナッツジュース</span>
  <span class='param'>[20, 95, 0, 0, 0, 0, 95, 20, 1000]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(119)'>
  <span class='name'>丸ごとパインジュース</span>
  <span class='param'>[0, 120, 0, 0, 0, 35, 155, 0, 1500]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(120)'>
  <span class='name'>青汁</span>
  <span class='param'>[0, 40, 0, 35, 0, 105, 75, 105, 2100]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(121)'>
  <span class='name'>タピオカミルクティー</span>
  <span class='param'>[110, 0, 60, 0, 0, 60, 0, 110, 1840]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(122)'>
  <span class='name'>タピオカスムージー</span>
  <span class='param'>[135, 40, 60, 0, 0, 0, 40, 75, 1970]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(123)'>
  <span class='name'>レインボー★タピオカ</span>
  <span class='param'>[135, 110, 75, 0, 0, 45, 155, 60, 5380]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(124)'>
  <span class='name'>ヴァンパイアカシス</span>
  <span class='param'>[40, 75, 40, 0, 0, 75, 150, 0, 2400]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(125)'>
  <span class='name'>ブルーワイン</span>
  <span class='param'>[55, 40, 90, 0, 35, 20, 40, 20, 1400]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(126)'>
  <span class='name'>抹茶ラテ</span>
  <span class='param'>[50, 45, 0, 0, 0, 65, 45, 115, 1610]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(127)'>
  <span class='name'>キャラメルマキアート</span>
  <span class='param'>[60, 75, 0, 100, 0, 0, 75, 160, 4050]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(128)'>
  <span class='name'>カフェモカ</span>
  <span class='param'>[45, 65, 0, 65, 0, 0, 65, 110, 1970]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(129)'>
  <span class='name'>レモネード</span>
  <span class='param'>[0, 75, 0, 0, 0, 0, 75, 0, 580]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(130)'>
  <span class='name'>ラッシー</span>
  <span class='param'>[125, 70, 0, 0, 45, 0, 70, 80, 2550]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(131)'>
  <span class='name'>コーラ</span>
  <span class='param'>[0, 55, 0, 0, 0, 30, 55, 30, 680]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(132)'>
  <span class='name'>メロンフロート</span>
  <span class='param'>[60, 160, 0, 0, 0, 0, 160, 60, 3490]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(133)'>
  <span class='name'>ミルクティー</span>
  <span class='param'>[35, 15, 0, 0, 0, 35, 15, 70, 680]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(134)'>
  <span class='name'>ベリージュース</span>
  <span class='param'>[0, 55, 0, 0, 0, 25, 80, 0, 630]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(135)'>
  <span class='name'>チョコバナナ</span>
  <span class='param'>[0, 85, 0, 0, 0, 0, 85, 0, 680]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(136)'>
  <span class='name'>アップルハニー</span>
  <span class='param'>[0, 80, 0, 0, 0, 0, 80, 0, 630]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(137)'>
  <span class='name'>ゴールデンアップル</span>
  <span class='param'>[0, 145, 0, 0, 0, 0, 145, 0, 1340]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(138)'>
  <span class='name'>アップルパイ</span>
  <span class='param'>[50, 110, 50, 30, 0, 30, 110, 0, 2400]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(139)'>
  <span class='name'>チーズケーキ</span>
  <span class='param'>[50, 50, 0, 45, 0, 45, 50, 50, 1340]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(140)'>
  <span class='name'>レアチーズケーキ</span>
  <span class='param'>[50, 110, 0, 60, 0, 60, 110, 50, 3490]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(141)'>
  <span class='name'>ショートケーキ</span>
  <span class='param'>[50, 135, 0, 50, 0, 50, 135, 50, 4050]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(142)'>
  <span class='name'>チョコレート蒸しパン</span>
  <span class='param'>[35, 70, 35, 0, 0, 0, 70, 0, 890]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(143)'>
  <span class='name'>クリスタルマウンテン</span>
  <span class='param'>[50, 85, 50, 35, 0, 35, 85, 0, 1840]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(144)'>
  <span class='name'>フォンダンショコラ</span>
  <span class='param'>[120, 115, 70, 35, 0, 35, 115, 50, 4880]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(145)'>
  <span class='name'>ミックスクッキー</span>
  <span class='param'>[35, 50, 35, 25, 0, 25, 50, 0, 940]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(146)'>
  <span class='name'>シュークリーム</span>
  <span class='param'>[85, 50, 45, 40, 0, 40, 50, 40, 1970]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(147)'>
  <span class='name'>コーヒーシュー</span>
  <span class='param'>[110, 65, 60, 50, 0, 50, 65, 50, 3700]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(148)'>
  <span class='name'>フルーツクレープ</span>
  <span class='param'>[65, 100, 0, 60, 0, 60, 100, 65, 3700]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(149)'>
  <span class='name'>北海道ミルクソフト</span>
  <span class='param'>[120, 60, 0, 0, 45, 0, 60, 75, 2100]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(150)'>
  <span class='name'>ギャラクシーソフト</span>
  <span class='param'>[130, 70, 0, 0, 65, 60, 130, 65, 4640]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(151)'>
  <span class='name'>パンケーキ</span>
  <span class='param'>[95, 50, 65, 30, 0, 30, 50, 30, 1970]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(152)'>
  <span class='name'>ドリームパフェ</span>
  <span class='param'>[110, 120, 0, 0, 50, 70, 190, 60, 5630]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(153)'>
  <span class='name'>キングプリン</span>
  <span class='param'>[50, 110, 0, 70, 0, 70, 110, 50, 3930]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(154)'>
  <span class='name'>フルーツタルト</span>
  <span class='param'>[50, 155, 0, 50, 0, 50, 155, 50, 4520]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(155)'>
  <span class='name'>モンブラン</span>
  <span class='param'>[45, 65, 0, 35, 0, 85, 115, 45, 2550]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(156)'>
  <span class='name'>抹茶スフレ</span>
  <span class='param'>[50, 40, 0, 0, 0, 100, 75, 115, 2400]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(157)'>
  <span class='name'>イチゴミルフィーユ</span>
  <span class='param'>[65, 145, 0, 50, 0, 50, 145, 65, 4640]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(158)'>
  <span class='name'>ベリームースケーキ</span>
  <span class='param'>[45, 100, 0, 0, 0, 55, 155, 45, 2720]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(159)'>
  <span class='name'>紅茶のシフォンケーキ</span>
  <span class='param'>[35, 45, 35, 35, 0, 90, 45, 55, 1840]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(160)'>
  <span class='name'>プリン</span>
  <span class='param'>[30, 25, 0, 30, 0, 30, 25, 30, 680]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(161)'>
  <span class='name'>レモンシャーベット</span>
  <span class='param'>[25, 60, 0, 0, 0, 0, 60, 25, 680]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(162)'>
  <span class='name'>イチゴパンナコッタ</span>
  <span class='param'>[75, 95, 0, 0, 25, 0, 95, 50, 1840]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(163)'>
  <span class='name'>エクレア</span>
  <span class='param'>[90, 35, 45, 60, 0, 60, 35, 45, 2250]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(164)'>
  <span class='name'>ドーナツ</span>
  <span class='param'>[85, 30, 0, 45, 50, 45, 30, 35, 1610]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(165)'>
  <span class='name'>チョコドーナツ</span>
  <span class='param'>[110, 90, 0, 45, 60, 45, 90, 50, 4280]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(166)'>
  <span class='name'>スイートポテト</span>
  <span class='param'>[65, 65, 65, 45, 0, 45, 65, 0, 1970]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(167)'>
  <span class='name'>チョコクリームクレープ</span>
  <span class='param'>[110, 50, 45, 60, 0, 60, 50, 65, 3490]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(168)'>
  <span class='name'>みたらし団子</span>
  <span class='param'>[70, 25, 110, 0, 40, 0, 25, 0, 1220]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(169)'>
  <span class='name'>ホールチーズ</span>
  <span class='param'>[85, 0, 15, 0, 45, 0, 0, 55, 840]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(170)'>
  <span class='name'>ミセスドーナツ</span>
  <span class='param'>[110, 65, 0, 90, 60, 90, 65, 50, 4760]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(171)'>
  <span class='name'>氷イチゴ</span>
  <span class='param'>[45, 165, 0, 0, 0, 0, 165, 45, 3080]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(172)'>
  <span class='name'>ラブ・イズ・ブルー</span>
  <span class='param'>[0, 155, 0, 0, 0, 100, 255, 0, 4520]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(173)'>
  <span class='name'>パンプキング</span>
  <span class='param'>[60, 70, 0, 95, 0, 160, 135, 60, 5380]</span>
</div>
<div class='menu'>
  <input type='button' value='eat' onclick='add(174)'>
  <span class='name'>カラフルマカロン</span>
  <span class='param'>[60, 115, 60, 100, 0, 100, 115, 0, 5010]</span>
</div>
                </div>
                <script>

/*
 * Tiny helpers.
 */

//// ensure_read_id (string) dom
var ensure_read_id = function (id) {
        const dom = document.getElementById(id);
        if (dom === null)
                throw new Error('Missing DOM id ' + id);
        return dom;
};

//// ensure_read_class (string,integer) dom
var ensure_read_class = function (name,length,root) {
        if (!root)
                root = document;
        const collection = root.getElementsByClassName(name);
        if (collection.length !== length)
                throw new Error('Class ' + name + ' has length ' + collection.length + ', not ' + length + " " + root);
        return collection;
};

/* 
 * READ layer 
 *
 * This layer's functions aceess DOM to return JSON objects.
 * Never used in EVAL and PRINT layer.
 *
 * */

//// G_NAMES
const g_names = ['life','awake','breath','strength','arm','tech','magic','luck'];

//// read_form_int (string) integer
var read_form_int = function (name) {
        const integer = parseInt(ensure_read_id(name)['value']);
        if (isNaN(integer))
                throw new Error(name + " is not integer.");
        return integer;
};

//// read_current_params () [integer]
var read_current_params = function () {
        return g_names.map(name => read_form_int(name));
};

//// DEFTYPE menu { name:string, param:[integer], dom:dom }
//// make_menu (dom) menu
var make_menu = function (dom) {
        return { name: dom.getElementsByClassName('name')[0].textContent
               , param: JSON.parse(dom.getElementsByClassName('param')[0].textContent)
               , dom: dom };
};

//// read_menu () [menu]
var read_menu = function () {
        const menu = document.getElementsByClassName('menu');
        let acc = []; // [menu]
        for(let i = 0; i < menu.length; i++) {
                acc.push(make_menu(menu[i]));
        };
        return acc;
};

//// read_nth_menu (integer) menu
var read_nth_menu = function (index) {
        return make_menu(document.getElementsByClassName('menu')[index]);
};

//// READ_EFFICIENT_SET () [dom]
var read_efficient_set = function () {
        const efficient_set = document.getElementsByClassName('set');
        let acc = [];
        for (let i=0; i<efficient_set.length; i++){
                acc.push(make_efficient_set(efficient_set[i]));
        }
        return acc;
}

/*
 * EVAL layer
 *
 * This layer's functions have no side-effect.
 * Just depending on arguments.
 *
 * */

//// EATABLEP (menu, [integer], integer) boolean
var eatablep = function (menu,current_params,next){
        return current_params.every((p,i) => 0 < next-p-menu.param[i]);
};

//// NONSENSEP (menu, integer) boolean
var nonsensep = function (menu, order_index) {
        return (0 === menu.param[order_index]);
};

//// COUNT_DIGESTABLE (dom, [integer], integer) integer
var count_digestable = function (menu, current_params, next) {
        return current_params
                .map((s,i) => next - s - menu.param[i])
                .reduce((acc,s) => s<=0?1+acc:acc,0);
};

//// DIFF (integer, [integer]) [integer]
var diff = function (next, current_params) {
        return current_params.map(p => next - p);
};

//// MATCH ([menu], [integer], integer) [menu]
var match = function (menu,current_params,next) {
        let acc = []; // [menu]
        menu.forEach(m => eatablep(m,current_params,next)?acc.push(m):null);
        return acc;
};

// DEFTYPE set [string]
//// unique_set ([set]) [set]
unique_set = function (a) {
        return a.map(set=>set.sort())
                .reduce(function(acc,next) {
                                if (acc.length === 0 || !acc.some(s=>s.every((e,i)=>e===next[i])))
                                        acc.push(next);
                                return acc;
                        }
                        ,[]);
};

//// SUM_PARAM (menu) integer
var sum_param = function (menu) {
        return menu.param.slice(0,8).reduce((x,y)=>x+y);
};

//// TURN_TO_DIGEST (menu, integer) integer
var turn_to_digest = function (menu, expected_exp) {
        return Math.ceil(menu.param[8]/expected_exp);
};

//// SORT_MENU ([menu],integer) [[integer,menu]]
var sort_menu = function (menu,expected_exp) {
        return menu.map(m=>[sum_param(m)/turn_to_digest(m,expected_exp),m])
                .sort((x,y)=>x[0]<y[0]);
};

//// RESULT_SET_STRING ([[menu]]) string
var result_set_string = function (acc,current_param) {
        return JSON.stringify(acc.map(function (a) {
                let result = a.map(m=>m.name);
                result.push(a.reduce((param,set)=>param.map((p,i)=>p+set.param[i])
                        ,current_param));
                return result;
        }));
};

//// DEFTYPE efficient_set { names: [name], param: [integer], dom: dom }
//// MAKE_EFFICIENT_SET (dom) efficient_set
var make_efficient_set = function (dom) {
        return { names: ensure_read_class('names',1,dom)[0].textContent
               , param: JSON.parse(ensure_read_class('param',1,dom)[0].textContent)
               , dom: dom };
};

//// CREATE_SET ([menu],[integer]) dom
var create_set = function (set,param) {
        const p = document.createElement('span');
        p.textContent = JSON.stringify(param);
        p.className = 'param';
        const names = document.createElement('span');
        names.textContent = JSON.stringify(set.map(m=>m.name));
        names.className = 'names';
        const eat = document.createElement('input');
        eat.type = 'button';
        eat.value = 'eat';
        eat.addEventListener("click", ()=>{
                set.forEach(m=>m.dom.getElementsByTagName('input')[0].onclick());
        }, false);
        const dom = document.createElement('div');
        dom.className = 'set';
        dom.appendChild(eat);
        dom.appendChild(p);
        dom.appendChild(names);
        return dom;
}

/*
 * PRINT layer.
 *
 * This layer's functions access DOM especially for print arguments.
 * Return value is undefined.
 */

//// HIDE (string) undefined
var hide = function (id) {
        ensure_read_id(id).style.display = 'none';
};

//// SHOW (string) undefined
var show = function (id) {
        ensure_read_id(id).style.display = '';
};

//// PRINT (string,string) undefined
var print = function (string,id) {
        ensure_read_id(id).textContent = string;
};

//// PUT (dom,string) undefined
var put = function (dom,string) {
        ensure_read_id(string).appendChild(dom);
};

/*
 * LOOP layer.
 *
 * This layer's functions are entry points.
 * Called from HTML event handlers.
 */

//// UPDATE () undefined
var update = function () {
        const menu = read_menu();
        var list = []; // [menu]
        var over = []; // [[menu,integer]]
        const order = ensure_read_id('order').selectedIndex;
        menu.forEach(function(m){
                if (eatablep(m, read_current_params(),read_form_int('next'))) {
                        list.push(m);
                        if (nonsensep(m, order))
                                m.dom.style.color = 'orange';
                        else
                                m.dom.style.color = '';
                } else {
                        over.push([m,count_digestable(m, read_current_params(), read_form_int('next'))]);
                        m.dom.style.color = 'red';
                }
        });
        list.sort((a,b) => a.param[order] < b.param[order]);
        list.forEach((m, i) => m.dom.style.order = i);
        over.sort((a,b) => (a[1] < b[1]));
        over.forEach((cons,i) => cons[0].dom.style.order = i+list.length);
        const efficient_set = read_efficient_set().sort((x,y)=>x.param[order]<y.param[order]);
        efficient_set.forEach((s,i)=>s.dom.style.order = i);
        if (g_eaten.length === 0) {
                hide('vomit');
                hide('digest');
                print("[]",'status');
        } else {
                show('vomit');
                show('digest');
                print(JSON.stringify(g_eaten.map(index => menu[index].name)),'status');
        };
};

//// G_EATEN
var g_eaten = []; // [integer]

//// ADD (integer) undefined
var add = function (index) {
        const param = read_nth_menu(index).param;
        g_eaten.push(index);
        g_names.forEach(function(name, i){
                let current_exp = read_form_int(name);
                ensure_read_id(name).value = param[i] + current_exp;
        });
        update();
};

//// SUB (integer) undefined
var sub = function (index) {
        const param = read_nth_menu(index).param;
        g_names.forEach(function(name, i){
                const current_exp = read_form_int(name);
                ensure_read_id(name).value = current_exp - param[i];
        });
        update();
};

//// VOMIT () undefined.
var vomit = function ()
{
        sub(g_eaten.pop());
        update();
};

//// DIGEST () undefined.
var digest = function ()
{
        g_eaten.shift();
        update();
};

//// EFFICIENT () [set]
var efficient = function () {
        const matched = match(read_menu(),read_current_params(),read_form_int('next')); // [menu]
        const expected_exp = read_form_int('exp'); // integer
        const current_param = read_current_params();
        const next = read_form_int('next');
        let status = 0;
        let acc = [];
        let memo = {};
        let rec = function (i,sorted,set,total) { // (integer,[[integer,menu]],[menu],integer)
                if (i===0)
                        return body(set.slice().sort((x,y)=>x.name<y.name), total);
                for(let index = 0; index<sorted.length; index++) {
                        set[i-1] = sorted[index][1];
                        if (rec(i-1,sorted,set,total+sorted[index][0]))
                                break;
                }
        };
        let body = function (set,total) { // ([menu],integer)
                if (eatablep(set.reduce((m,n)=>{return{param:m.param.map((p,i)=>p+n.param[i])};}),current_param,next)
                        && !memo[set.map(m=>m.name).toString()]
                )
                        {
                                memo[set.map(m=>m.name).toString()] = true;
                                if (total<status)
                                        return true;
                                if (total===status)
                                        acc.push(set);
                                else {
                                        status = total;
                                        acc = [set];
                                }
                        }
                return false;
        };
        print("NOTE: This may take some minutes.",'efficient-set');
        setTimeout(function(){
                for(let i = 1; i <= 3; i++) {
                        rec(i,sort_menu(matched,expected_exp/i),new Array(i),0)
                };
                const order = ensure_read_id('order').selectedIndex;
                (0 < acc.length)
                        ?acc
                        .map(s=>[s,s.reduce((param,set)=>param.map((p,i)=>p+set.param[i])
                                ,current_param)])
                        .sort((m,n)=>m[1][order]<n[1][order])
                        .forEach(c=>put(create_set(c[0],c[1]),'efficient-set'))
                        :((e => (0 < e.length)
                                ?print(JSON.stringify(e), 'efficient-set')
                                :print("[]",'efficient-set'))
                          (enough()))
        }
                ,50);
};

//// ENOUGH () [set]
var enough = function () {
        const m = read_menu(); // [m]
        const p = diff(read_form_int('next'),read_current_params()); // [integer]
        let z = 0; // integer
        let s = p.reduce((x,y)=>x+y); // integer
        let acc = []; // [set]
        let rec = function(i,set) {
                if (i < 3) {
                        m.forEach(function (m) {
                                set[i] = m;
                                rec(i+1, set);
                        })
                }
                else
                { body(set); }
        };
        let body = function (set) {
                const rp = set.reduce((acc,m)=>acc.map((s,i)=>s-m.param[i]) ,p);
                const ms = rp.reduce((acc,p)=>p<=0?acc+1:acc,0);
                const ts = rp.reduce((x,y)=>x+y);
                if (ms < z) { // Do nothing.
                } else if (ms === z) {
                        if (ts < s) {
                                s = ts;
                                acc = [set.map(m=>m.name)];
                        } else if (ts === s)
                                acc.push(set.map(m=>m.name));
                        else { } // Do nothing.
                } else {
                        z = ms;
                        s = ts;
                        acc = [set.map(m=>m.name)];
                }
        };
        rec(0, new Array (3));
        return unique_set(acc);
};

//// Setup event listener.
var input = document.getElementsByClassName("input");
for(let i = 0; i < input.length; i++){
        input[i].addEventListener("change", update, false);
};

//// HOW_TO_USE () undefined.
var how_to_use = function () {
        let toggler = ensure_read_id('how-to-use-switch');
        if (toggler.value === "Show how to use") {
                toggler.value = "Hide";
                show('how-to-use');
        } else {
                toggler.value = "Show how to use";
                hide('how-to-use');
        }
};

//// LEVELUP
var levelup = function () {
        const next = read_form_int('next');
        g_names.forEach(name=>{
                const value = read_form_int(name);
                if (next<=value)
                        ensure_read_id(name).value = value-next;
        });
};

//// Initial setup.
update();
how_to_use();
                </script>
        </body>
</html>
